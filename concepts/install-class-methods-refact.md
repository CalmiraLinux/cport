# Рефакторинг методов класса `cp_install.install()` [DONE]

> **Автор:** [Михаил Краснов](https://github.com/Linuxoid85)

> **E-mail:** [linuxoid85@gmail.com](mailto:linuxoid85@gmail.com)

> **Категория:** Рефакторинг кода.

Ради повышения читабельности и увеличения шансов дальнейших правок модуля `cp_install` требуется произвести рефакторинг отдельных областей кода, в частности, класса `install()`.

## Причины

Нечитабельность `install.__init__()` и некоторых других функций, а так же сложность внесения изменений в код этого метода.

## Реализация

Требуется реализовать следующую последовательнсть действий:

1. Проверка наличия необходимых файлов:
    - `config.json`;
    - `resources.conf`;
    - `install`;
2. Проверка на нахождение порта в чёрном списке;
    - Здесь требуется обращение к БД `blacklists.db` с поиском указанного порта.
3. Проверка на приоритет порта;
    - Здесь проверка `priority` из `config.json` указанного порта.
4. Проверка на соответствие порта релизу Calmira GNU/Linux;
    - Проверка `release` из `config.json` указанного порта на соответствие значению `distroVersion` файла `/etc/calm-release`.
5. Получение базовой информации о порте;
6. Получение информации о зависимостях;
7. Скачивание архивов;
    - Ссылка для скачивания содержится в `resources.conf` указанного порта;
8. Распаковка архивов;
    - Полученный в результате скачивания архив указан в `resources.conf`;
9. Выполнение инструкций сборки.
    - Выполнение файла `install` указанного порта.

| Метод                        | Описание                                                    |
|------------------------------|-------------------------------------------------------------|
| `cdf.check.install(port)`    | Проверка на наличие необходимых файлов для сборки порта     |
| `cpb.check_bl(port)`         | Проверка на нахождение порта в чёрном списке [DEPRECATED]   |
| `cpb.fetch(port)`            | Проверка на нахождение порта в чёрном списке                |
| `cpI.get.priority(config)`   | Получение приоритета порта                                  |
| `cdf.check.release(config)`  | Проверка на совместимость порта с релизом Calmira GNU/Linux |
| `cpI.info.port(config)`      | Получение базовой информации о порте                        |
| `cpI.info.depends([config])` | Получение информации о зависимостях                         |
| `prepare.download(link)`     | Скачивание архива с исходным кодом порта                    |
| `prepare.unpack(file)`       | Распаковка полученного архива с исходным кодом порта        |
| `install.build(instruction)` | Сборка порта из полученного и распакованного исходного кода |